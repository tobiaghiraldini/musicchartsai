{% extends "admin/base_site.html" %}
{% load i18n admin_urls static admin_list %}

{% block title %}{{ title }} | {{ site_title|default:_('Django site admin') }}{% endblock %}

{% block extrastyle %}
  {{ block.super }}
  <link rel="stylesheet" type="text/css" href="{% static "admin/css/changelists.css" %}">
  <link rel="stylesheet" type="text/css" href="{% static "soundcharts/css/admin_data_table.css" %}">
{% endblock %}

{% block extrahead %}
  {{ block.super }}
  <script>
    // Pass data to JavaScript
    window.tableData = {{ table_data|safe }};
  </script>
  <script src="{% static 'soundcharts/js/admin_data_table.js' %}"></script>
{% endblock %}

{% block content %}
<div id="content-main">
  <div class="ranking-header">
    <div class="ranking-title">{{ ranking.chart.name }}</div>
    <div class="ranking-meta">
      Ranking Date: {{ ranking.ranking_date|date:"F j, Y" }} | 
      Platform: {{ ranking.chart.platform.name }} | 
      Frequency: {{ ranking.chart.frequency }}
    </div>
    
    <div class="summary-stats">
      <div class="stat-item">
        <div class="stat-number">{{ entries.count }}</div>
        <div class="stat-label">Total Entries</div>
      </div>
      <div class="stat-item">
        <div class="stat-number">{{ ranking.total_entries }}</div>
        <div class="stat-label">API Total</div>
      </div>
      <div class="stat-item">
        <div class="stat-number">{{ ranking.chart.platform.name }}</div>
        <div class="stat-label">Platform</div>
      </div>
    </div>
  </div>

  {% if entries %}
    <div class="data-table-container">
      <div class="table-controls">
        <input type="text" id="searchBox" class="search-box" placeholder="Search tracks, artists, trends...">
        <div class="table-info" id="tableInfo">
          Showing {{ entries.count }} entries
        </div>
      </div>
      
      <table id="entriesTable" class="data-table">
        <thead>
          <tr>
            <!-- Headers will be generated by JavaScript -->
          </tr>
        </thead>
        <tbody>
          <!-- Data will be generated by JavaScript -->
        </tbody>
      </table>
      
      <div class="pagination" id="pagination">
        <!-- Pagination will be generated by JavaScript -->
      </div>
    </div>
  {% else %}
    <div class="module">
      <h2>No entries found</h2>
      <p>This chart ranking doesn't have any entries yet.</p>
    </div>
  {% endif %}
  
  <div class="submit-row">
    <a href="{% url 'admin:soundcharts_chartranking_change' ranking.id %}" class="button secondary">← Back to Ranking</a>
    <a href="{% url 'admin:soundcharts_chartranking_changelist' %}" class="button secondary">← All Rankings</a>
  </div>
</div>
{% endblock %}
