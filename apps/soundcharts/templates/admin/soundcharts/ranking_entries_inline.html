{% load static %}

<div class="ranking-entries-inline">
  <div class="ranking-header">
    <div class="ranking-title">{{ ranking.chart.name }}</div>
    <div class="ranking-meta">
      Ranking Date: {{ ranking.ranking_date|date:"F j, Y" }} | 
      Platform: {{ ranking.chart.platform.name }} | 
      Frequency: {{ ranking.chart.frequency }}
    </div>
    
    <div class="summary-stats">
      <div class="stat-item">
        <div class="stat-number">{{ entries.count }}</div>
        <div class="stat-label">Total Entries</div>
      </div>
      <div class="stat-item">
        <div class="stat-number">{{ ranking.total_entries }}</div>
        <div class="stat-label">API Total</div>
      </div>
      <div class="stat-item">
        <div class="stat-number">{{ ranking.chart.platform.name }}</div>
        <div class="stat-label">Platform</div>
      </div>
    </div>
  </div>

  {% if entries %}
    <div class="data-table-container">
      <div class="table-controls">
        <input type="text" id="searchBox_{{ ranking.id }}" class="search-box" placeholder="Search tracks, artists, trends...">
        <div class="table-info" id="tableInfo_{{ ranking.id }}">
          Showing {{ entries.count }} entries
        </div>
      </div>
      
      <table id="entriesTable_{{ ranking.id }}" class="data-table">
        <thead>
          <tr>
            <!-- Headers will be generated by JavaScript -->
          </tr>
        </thead>
        <tbody>
          <!-- Data will be generated by JavaScript -->
        </tbody>
      </table>
      
      <div class="pagination" id="pagination_{{ ranking.id }}">
        <!-- Pagination will be generated by JavaScript -->
      </div>
    </div>
  {% else %}
    <div class="module">
      <h2>No entries found</h2>
      <p>This chart ranking doesn't have any entries yet.</p>
    </div>
  {% endif %}
</div>

<script>
  // Initialize the data table for this ranking
  document.addEventListener('DOMContentLoaded', function() {
    if (typeof AdminDataTable !== 'undefined') {
      // Pass data to JavaScript
      window.tableData_{{ ranking.id }} = {{ table_data|safe }};
      
      // Initialize the table
      new AdminDataTable(
        'entriesTable_{{ ranking.id }}', 
        window.tableData_{{ ranking.id }},
        {
          pageSize: 25,
          sortable: true,
          searchable: true
        }
      );
    }
  });
</script>
